let totalPrice=0;function countItemsSelected(){return Array.from(document.getElementById("productsSelectedRows").children).length}function setTotalPrice(){document.getElementsByName("final_price")[0].value=calculateTotalPrice().toFixed(2)}function calculateTotalPrice(){return Array.from(document.getElementById("productsSelectedRows").children).reduce((function(e,t){let n=0,c=0;return Array.from(t.children).forEach((function(e){"unitPrice"==e.name&&(c=e.dataset.unitPrice),"quantity"==e.name&&(n=e.dataset.quantity)})),e+c*n}),0)}function createRow(e,t){let n=document.createElement("tr");n.name="product_id",n.className="row-"+e.id;let c=document.createElement("td");c.name="productSku",c.innerHTML=e.sku;let a=document.createElement("td");a.name="productName",a.innerHTML=e.name;let r=document.createElement("td");r.name="unitPrice",r.innerHTML=e.unitPrice+" ("+e.currency+")",r.dataset.unitPrice=e.unitPrice;let d=document.createElement("td");d.name="quantity",d.innerHTML=t,d.dataset.quantity=t;let u=document.createElement("td");const i=e.unitPrice*t;return u.name="subtotal",u.innerHTML=i+" ("+e.currency+")",u.dataset.subtotal=i,n.appendChild(c),n.appendChild(a),n.appendChild(r),n.appendChild(d),n.appendChild(u),n}function addProductToTable(e,t,n){if(0==document.getElementsByClassName("row-"+e.id).length){const n=createRow(e,t);$("#productsSelectedRows").append(n),setTotalPrice()}else alert("El producto ya esta agregado al pedido, eliminelo e agreguelo nuevamente si quiere cambiar la cantidad")}function createInputsToSubmit(e,t,n,c){const a=document.createElement("input"),r=document.createElement("input"),d=document.createElement("input");a.name=`products[${c}][id]`,a.value=e,r.name=`products[${c}][quantity]`,r.value=n,d.name=`products[${c}][unit_price]`,d.value=t,document.getElementById("productsOrder").appendChild(a),document.getElementById("productsOrder").appendChild(r),document.getElementById("productsOrder").appendChild(d)}function setProductsOrderRequest(){Array.from(document.getElementById("productsSelectedRows").children).forEach((function(e,t){const n=e.className.replace("row-","");let c=0;Array.from(e.children).forEach((function(e){"unitPrice"==e.name&&(unitPrice=e.dataset.unitPrice),"quantity"==e.name&&(c=e.dataset.quantity)})),createInputsToSubmit(n,unitPrice,c,t)}))}function fillItemsTable(){if(void 0!==document.getElementsByName("items")[0]){let e=document.getElementById("productsSelected"),t=document.getElementsByName("items")[0].value;JSON.parse(t).forEach((t=>{addProductToTable(t,t.quantity,e)})),$("#productsSelected").css("display","")}}$(document).ready((function(){fillItemsTable()}));